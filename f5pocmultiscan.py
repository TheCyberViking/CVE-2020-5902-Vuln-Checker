import requests
import csv
import pandas as pd
from termcolor import colored, cprint
from requests.packages.urllib3.exceptions import InsecureRequestWarning

results = []
print("Simple F5 Vulnerablity Scanner by @TheCyberViking and @Rag_Sec")
target = input("Please input the path to the file: ")
lineList = [line.rstrip('\n') for line in open(target,"r")]
for line in lineList:
                targetURL=("https://" + line +"/tmui/login.jsp")
                try:
                                requests.packages.urllib3.disable_warnings(InsecureRequestWarning)
                                response = requests.get(targetURL, verify=False, timeout = 2)
                                if response.status_code == 200:
                                                cprint((line, ' is Vulnerable'), 'green')
                                                compresults=(line + ',' + targetURL)
                                                results.append(compresults)
                                elif response.status_code == 404:
                                                cprint((line, " Not Vulnerable"), 'red')
                except (KeyboardInterrupt, SystemExit):
                                sys.exit()
                except:
                                cprint((line, " Failed"), 'red')
filename = input("Please input a filename: ")
pd.DataFrame(results).to_csv(filename + '.csv')
